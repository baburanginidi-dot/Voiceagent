1. Core Database Schema
Users Table
users:
â”œâ”€â”€ id (serial) - Primary key
â”œâ”€â”€ name (text) - Student's name
â”œâ”€â”€ phone (text) - Unique identifier
â”œâ”€â”€ current_stage (int) - Which stage they're at (1-6)
â”œâ”€â”€ created_at (timestamp)
â””â”€â”€ updated_at (timestamp)

Onboarding Stages Table
onboarding_stages:
â”œâ”€â”€ id (int) - Stage number (1, 2, 3, 4, 5, 6)
â”œâ”€â”€ name (text) - "Introduction", "Program Value", etc.
â”œâ”€â”€ description (text) - What this stage does
â”œâ”€â”€ stage_order (int) - Sequence order
â””â”€â”€ is_active (boolean)

System Prompts Table (Stage-Specific AI Instructions)
system_prompts:
â”œâ”€â”€ id (serial) - Primary key
â”œâ”€â”€ stage_id (int) â†’ links to onboarding_stages
â”œâ”€â”€ prompt (text) - The AI instruction for this stage
â”œâ”€â”€ version (int) - Version control
â”œâ”€â”€ is_active (boolean)
â”œâ”€â”€ metadata (jsonb) - Extra config like knowledge base
â”œâ”€â”€ created_at / updated_at

Admin Documents Table (RAG Knowledge Base)
admin_documents:
â”œâ”€â”€ id (serial)
â”œâ”€â”€ stage_id (int) â†’ links to stage
â”œâ”€â”€ filename (text)
â”œâ”€â”€ content (text) - Uploaded document content
â”œâ”€â”€ created_at

2. System Instruction Architecture
The AI receives a combined prompt built from multiple layers:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: GLOBAL INSTRUCTION                â”‚
â”‚  (Base behavior, tone, personality)         â”‚
â”‚  "You are Maya, NxtWave's voice assistant"  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 2: TURN-TAKING RULES                 â”‚
â”‚  (Conversation protocol)                    â”‚
â”‚  "Speak 1-2 sentences, wait for response"   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 3: STAGE-SPECIFIC PROMPT             â”‚
â”‚  (What to say at THIS stage)                â”‚
â”‚  "STAGE 1: Greet user, ask name..."         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 4: RAG DOCUMENTS (Optional)          â”‚
â”‚  (Injected knowledge for this stage)        â”‚
â”‚  "FAQ answers, pricing info, etc."          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. Stage Configuration Prompts
Here's how to write prompts for each stage:

Stage 1: Introduction
STAGE 1: Introduction
- GOAL: Warmly greet the student and verify identity
- NARRATIVE: "Hello {{studentName}}! Nenu Maya, NxtWave ki. Meeru maa program lo interest chupincharu, kuda..."
- ACTIONS: 
  - Confirm student's name
  - If confirmed, call setStage(2)
- VALID RESPONSES: "Yes", "Correct", "That's me"

Stage 2: Program Value
STAGE 2: Program Value
- GOAL: Explain program benefits, check understanding
- NARRATIVE: "Idi mee career ni transform chese journey..."
- KEY POINTS: 3000+ companies, real projects, mentor support
- ACTIONS:
  - Ask "Do you understand?"
  - If yes, call setStage(3)

Stage 3-6: Continue Pattern...
4. Database Flow Diagram
User Login
    â”‚
    â”œâ”€â”€â–¶ Fetch user.current_stage (e.g., Stage 1)
    â”‚
    â”œâ”€â”€â–¶ Load GLOBAL instruction from system_prompts (stageId = null)
    â”‚
    â”œâ”€â”€â–¶ Load STAGE prompt from system_prompts (stageId = 1)
    â”‚
    â”œâ”€â”€â–¶ Load RAG documents from admin_documents (stageId = 1)
    â”‚
    â”œâ”€â”€â–¶ COMBINE â†’ Final System Instruction
    â”‚
    â””â”€â”€â–¶ Send to Gemini Live API â†’ Maya speaks

5. Sample System Instruction Template
ğŸ™ï¸ YOU ARE: Maya, a friendly voice AI for NxtWave
ğŸ—£ï¸ LANGUAGE: Tenglish (Telugu + English mix)
- Use Telugu words naturally: "Namaste", "Baagunnara", "Thelusu"
- Keep English for technical terms
ğŸ“ CONVERSATION RULES:
1. Speak 1-2 sentences maximum per turn
2. Pause after every question
3. Wait for user's spoken response
4. Never answer your own questions
ğŸ‘¤ USER INFO:
- Name: {{studentName}}
- Phone: {{phoneNumber}}
- Current Stage: {{currentStage}}
ğŸ¯ CURRENT TASK (Stage {{stageId}}):
{{stagePrompt}}
ğŸ“š KNOWLEDGE BASE:
{{ragDocuments}}
ğŸ› ï¸ AVAILABLE TOOLS:
- setStage(stageId) - Move user to next stage
- completeOnboarding(method) - Mark as completed
- requestExpert() - Transfer to human agent

6. Admin Panel Configuration
The Admin Panel should allow editing:

Field	Purpose
Global Instruction	Base AI personality/behavior
Stage 1-6 Prompts	Specific dialogue for each stage
RAG Documents	Upload knowledge files per stage
Metadata	Extra config (knowledge base summaries)
Would you like me to create a task list to implement or improve any specific part of this database structure?